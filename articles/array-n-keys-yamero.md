---
title: "[...Array(n).keys()] ã¯ã‚„ã‚ãŸæ–¹ãŒã„ã„ã®ã§ã¯ï¼Ÿ"
emoji: "ğŸ“€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript"]
published: true
---

`[...Array(n).keys()]`ã¯ã€JavaScriptã§`0`ã‹ã‚‰`n-1`ã¾ã§ã®æ•´æ•°ãŒé †ç•ªã«ä¸¦ã‚“ã é…åˆ—ã‚’å¾—ã‚‹è¨˜æ³•ã§ã™ã€‚

```js
const arr = [...Array(5).keys()]
console.log(arr); // [0, 1, 2, 3, 4]
```

ã“ã®è¨˜äº‹ã§ã¯ã€**ã“ã‚Œã¯ã‚„ã‚ãŸæ–¹ãŒã„ã„ã®ã§ã¯**ã¨ã„ã†ã“ã¨ã‚’ä¸»å¼µã—ã¾ã™ã€‚

## ç†ç”±

**èª­ã¿æ‰‹ã«ã‹ã‹ã‚‹è² è·ãŒé«˜ã„**ï¼ˆâ‰’ç†è§£ã—ã«ãã„ï¼‰ã‹ã‚‰ã§ã™ã€‚ç‰¹ã«ã€`Array(n).keys()`ã®æŒ™å‹•ã‚’æ­£ç¢ºã«æŠŠæ¡ã™ã‚‹é›£æ˜“åº¦ãŒé«˜ããªã£ã¦ã„ã¾ã™ã€‚ã‹ã¨ã„ã£ã¦ã€`[...Array(n).keys()]`ã¨ã„ã†é•·ã„ã‚³ãƒ¼ãƒ‰ã‚’ä¸­èº«ã‚’æ°—ã«ã›ãšã‚¤ãƒ‡ã‚£ã‚ªãƒ ã¨ã—ã¦è¦šãˆã‚‹ã®ã¯è„³ã®è¨˜æ†¶é ˜åŸŸã®ç„¡é§„é£ã„ã§ã™ã€‚

ä»¥ä¸‹ã§ã¯ã€`Array(n)`ã¨`keys()`ã«é–¢ã—ã¦è¦‹ã¦ã„ãã€é›£æ˜“åº¦ã®é«˜ã•ã‚’å®Ÿæ„Ÿã—ã¾ã™ã€‚

### `Array(n)`ã¨empty

`Array(n)`ã¯`new Array(n)`ã§ã¨åŒã˜æ„å‘³ã§ã€ä¸€è¨€ã§è¨€ãˆã°**é•·ã•`n`ã®é…åˆ—ã‚’ä½œã‚‹**ã¨ã„ã†ã“ã¨ã§ã™ã€‚

ã¡ãªã¿ã«ã€ã“ã®æ©Ÿèƒ½è‡ªä½“ã‚‚ã‚ã¾ã‚Šä½¿ã†ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãªãœãªã‚‰ã€`n`ã¨ã—ã¦æ•°å€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã®ã¿ãŒç‰¹åˆ¥æ‰±ã„ã•ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚

```js
console.log(Array(5));    // [empty Ã— 5]
console.log(Array("5"));  // ["5"]
console.log(Array(true)); // [true]
console.log(Array(5, 5)); // [5, 5]
```

ã“ã®ã‚ˆã†ã«ã€æ•°å€¤ãŒä¸€ã¤ã ã‘ä¸ãˆã‚‰ã‚ŒãŸå ´åˆã®ã¿ã€Œãã®é•·ã•ã‚’æŒã¤é…åˆ—ã‚’ä½œã‚‹ã€ã¨ã„ã†æ„å‘³ã«ãªã‚Šã€ãã‚Œä»¥å¤–ã®å ´åˆã¯å…¨ã¦ã€Œä¸ãˆã‚‰ã‚ŒãŸå€¤ã‚’è¦ç´ ã«æŒã¤é…åˆ—ã‚’ä½œã‚‹ã€ã¨ã„ã†æ„å‘³ã«ãªã‚Šã¾ã™ã€‚

ã¨ã“ã‚ã§ã€å•é¡Œã®`Array(5)`ã®çµæœãŒ`[empty Ã— 5]`ã¨ãªã£ã¦ã„ã¾ã™ï¼ˆChromeã®å ´åˆã®è¡¨ç¤ºï¼‰ã€‚ã“ã‚Œã¯ã€ã€Œä¸­èº«ã¯ä½•ã‚‚å…¥ã£ã¦ã„ãªã„ãŒé•·ã•ãŒ5ã®é…åˆ—ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚JavaScriptã§ã¯é…åˆ—ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸€ç¨®ã§ã‚ã‚Šé…åˆ—ã®0ç•ªç›®ã®è¦ç´ ã¯`"0"`ã¨ã„ã†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã§ã‚ã‚‹ï¼ˆãªã®ã§`arr[0]`ã¯`arr["0"]`ã¨åŒã˜æ„å‘³ï¼‰ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã“ã§ã„ã†ã€Œä¸­èº«ã¯ä½•ã‚‚å…¥ã£ã¦ã„ãªã„ã€ã¨ã¯ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã™ã‚‰å­˜åœ¨ã—ãªã„ã¨ã„ã†ã“ã¨ã‚’æ„å‘³ã—ã¦ã„ã¾ã™ã€‚

```js
const arr = Array(5);
console.log(arr.length); // 5
console.log(arr[0]);     // undefined
console.log(arr.hasOwnProperty("0")); // false
```

å¿µã®ãŸã‚ã«æ³¨æ„ã—ã¦ãŠãã¨ã€emptyã¯ã€Œ`undefined`ãŒå…¥ã£ã¦ã„ã‚‹ã€ã¨ã¯ç•°ãªã‚Šã¾ã™ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã™ã‚‹ã‹ã—ãªã„ã‹ã®ç‚¹ã§ï¼‰ã€‚

```js
const arr = Array(5);
arr[1] = undefined;

console.log(arr); // [empty, undefined, empty Ã— 3]

console.log(arr.hasOwnProperty("0")); // false
console.log(arr.hasOwnProperty("1")); // true
```


### emptyã®é›£è§£ãªæŒ™å‹•

ã“ã®ã€ã€Œ`0`ã€œ`arr.length-1`ã®é–“ã«ã‚ã‚‹ãŒãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ãªã„è¦ç´ ã€ã®ã“ã¨ã¯ä¿—ã«emptyã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚emptyã®æŒ™å‹•ã¯ãªã‹ãªã‹éç›´æ„Ÿçš„ã§ã€ç†Ÿç·´ã®JavaScriptä½¿ã„ã§ã‚‚ãã®ä»•æ§˜ã‚’è«³ã‚“ã˜ã‚‹ã®ã¯ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ä¾‹ãˆã°ã€pushã™ã‚‹ã¨emptyã®å¾Œã‚ã«pushã•ã‚Œã¾ã™ã€‚

```js
const arr = Array(5);
arr.push(123);
console.log(arr); // [empty Ã— 5, 123]
```

emptyã¯ã€`forEach`ã‚„`map`ã§ã¯ç„¡è¦–ã•ã‚Œã¾ã™ï¼ˆ`map`ã§ã¯emptyã«å¯¾ã—ã¦é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œãšã€çµæœã®é…åˆ—ã§ã¯emptyã®ã¾ã¾ã§ã™ï¼‰ã€‚

```js
const arr = Array(5);
arr.push(123);
console.log(arr); // [empty Ã— 5, 123]

// 123 ã ã‘è¡¨ç¤ºã•ã‚Œã‚‹
arr.forEach(x => console.log(x));

const arr2 = arr.map(x => x * 10);
console.log(arr2); // [empty Ã— 5, 1230]

const arr3 = arr.map((_, i) => i);
console.log(arr3); // [empty Ã— 5, 5]
```

`some`ã‚„`every`ã§ã‚‚emptyã¯åˆ¤å®šå¯¾è±¡ã«å…¥ã‚Šã¾ã›ã‚“ã€‚

```js
const arr = Array(5);
arr.push(123);
console.log(arr.every(x => x === 123)); // true
```

ãªãŠã€æ„šç›´ã«ã‚«ã‚¦ãƒ³ã‚¿é–¢æ•°ã‚’ä½¿ã†`for`æ–‡ã®å ´åˆã¯ã€å½“ç„¶ãªãŒã‚‰emptyã¯ç„¡è¦–ã•ã‚Œã¾ã›ã‚“ï¼ˆemptyã®ä½ç½®ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã€ã€Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å­˜åœ¨ã—ãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨`undefined`ã«ãªã‚‹ã€ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦`undefined`ã¨ãªã‚Šã¾ã™ï¼‰ã€‚

```js
const arr = Array(5);
arr.push(123);

// undefined undefined undefined
// undefind undefined 123
// ã¨è¡¨ç¤ºã•ã‚Œã‚‹
for (let i = 0; i < arr.length; i++) {
  console.log(arr[i]);
}
```

ã¨ã¯ã„ã£ã¦ã‚‚ã€`indexOf`ã§`undefined`ã‚’æ¢ã™å ´åˆã€emptyã¯`undefined`ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã›ã‚“ã€‚

```js
const arr = Array(5);

console.log(arr.indexOf(undefined)); // -1
```

### ES2015ä»¥é™ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯emptyã‚’æ‰±ãˆã‚‹

é…åˆ—ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã§ã‚‚ã€ES2015ã§è¿½åŠ ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã¯emptyã‚’æ„ŸçŸ¥ã§ãã‚‹ï¼ˆ`undefined`ãŒå…¥ã£ã¦ã„ã‚‹è¦ç´ ã¨åŒã˜æ‰±ã„ã‚’ã™ã‚‹ï¼‰å‚¾å‘ã«ã‚ã‚Šã¾ã™ã€‚

```js
const arr = Array(5);

console.log(arr.findIndex(x => x === undefined)); // 0
console.log(arr.includes(undefined)); // true
```

ã¾ãŸã€`fill`ã‚’ä½¿ã†ã¨emptyéƒ¨åˆ†ã‚’ä»–ã®å€¤ã§ä¸Šæ›¸ãã§ãã¾ã™ã€‚

```js
const arr = Array(5);
arr.fill(123);

console.log(arr); // [123, 123, 123, 123, 123]
```

ä»¥ä¸Šã®æƒ…å ±ã‹ã‚‰ã€å•é¡Œã®`[0, 1, 2, 3, 4]`ã‚’ä½œã‚‹ã®ã«æ¬¡ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚’è¸ã‚€ã¨ã„ã†æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ï¼ˆã“ã‚Œã‚‚ã‚„ã‚ã‚‹ã¹ãã ã¨æ€ã„ã¾ã™ãŒï¼‰ã€‚

```js
const arr = Array(5).fill(0).map((_, i) => i);
console.log(arr); // [0, 1, 2, 3, 4]
```

ã“ã‚Œã¯ã€`[empty Ã— 5]`ã‚’`fill`ã§`[0, 0, 0, 0, 0]`ã«å¤‰æ›ã—ã€ãã‚Œã‚’`map`ã§`[0, 1, 2, 3, 4]`ã«å¤‰æ›ã—ã¦ã„ã¾ã™ï¼ˆå…ˆè¿°ã®é€šã‚Šã€`[empty Ã— 5]`ã«ç›´æ¥`map`ã‚’ä½¿ã£ã¦ã‚‚`[empty Ã— 5]`ã®ã¾ã¾ã§ã™ï¼‰ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ç³»ã®ãƒ¡ã‚½ãƒƒãƒ‰

é…åˆ—ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ç³»ã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆ`keys`, `values`, `entries`ï¼‰ã‚‚ã‚„ã¯ã‚ŠES2015ã§è¿½åŠ ã•ã‚ŒãŸã‚‚ã®ã§ã€emptyã‚’ç„¡è¦–ã—ã¾ã›ã‚“ï¼ˆ`undefined`ãŒå…¥ã£ã¦ã„ã‚‹è¦ç´ ã¨åŒã˜ã‚ˆã†ã«æ‰±ã„ã¾ã™ï¼‰ã€‚

```js
const arr = Array(5);

console.log([...arr.values()]); // [undefined, undefined, undefined, undefined, undefined]

// [[0, undefined], [1, undefined], [2, undefined],
//  [3, undefined], [4, undefined]]
console.log([...arr.entries()]);

console.log([...arr.keys()]); // [0, 1, 2, 3, 4]
```

ã“ã“ã§`keys()`ãŒç™»å ´ã—ã¾ã—ãŸã­ã€‚ã“ã‚Œã¯é…åˆ—ã®å„è¦ç´ ã®ã‚­ãƒ¼åã‚’é †ã«å‡ºåŠ›ã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ãŒã€emptyã§ã‚ã£ã¦ã‚‚ç„¡è¦–ã—ãªã„ã®ã§ã€`[empty Ã— 5]`ã§ã‚ã£ã¦ã‚‚`[undefined, undefined, undefined, undefined, undefined]`ã¨åŒã˜ã‚ˆã†ã«æ‰±ã„ã€0ã€œ4ã®è¦ç´ ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã‹ã®ã‚ˆã†ã«æŒ¯èˆã„ã¾ã™ã€‚ã“ã‚ŒãŒ`[...arr.keys()]`ãŒ`[0, 1, 2, 3, 4]`ã¨ãªã‚‹ç†ç”±ã§ã™ã€‚

ã“ã“ã§è¡¨é¡Œã®`[...Array(5).keys()]`ã®æ„å‘³ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã­ã€‚ã¾ãš`Array(5)`ã§`[empty Ã— 5]`ã‚’ä½œã‚Šã€keys()ã§ãã“ã‹ã‚‰`0, 1, 2, 3, 4`ã‚’å‡ºåŠ›ã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’å¾—ã¦ã€`...`ã§ãã‚Œã‚’é…åˆ—ã«å¤‰æ›ã—ã¦`[0, 1, 2, 3, 4]`ã‚’å¾—ã¦ã„ã¾ã™ã€‚

ä»¥ä¸Šã®æŒ™å‹•ã‚’ç†è§£ã™ã‚‹ã«ã¯ã€`Array(5)`ãŒemptyã‹ã‚‰æˆã‚‹é…åˆ—ã‚’ä½œã‚‹ã“ã¨ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãã®ä¸Šã§`keys()`ã¯emptyã‚‚`undefinde`ã¨åŒæ§˜ã«æ‰±ã†ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯éå¸¸ã«ã‚„ã‚„ã“ã—ã„ã®ã§ã€é¿ã‘ã‚‹ã¹ãã§ã™ã€‚

## ã§ã¯ã©ã†ã™ã‚‹ã®ãŒè‰¯ã„ã‹

ç­†è€…ã®ãŠå‹§ã‚ã®æ–¹æ³•ã¯ã“ã‚Œã§ã™ã€‚

```ts
console.log([...range(0, 5)]); // [0, 1, 2, 3, 4]

/**
 * Returns an iterator that iterates integers in [start, end).
 */
function* range(start, end) {
  for (let i = start; i < end; i++) {
    yield i;
  }
}
```

`Array(n).keys()`ã¯ä¸Šã§å®šç¾©ã—ãŸ`range`ã‚’ä½¿ã£ã¦`range(0, n)`ã¨æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã¡ã‚‰ã®ã»ã†ãŒ`range`ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›¸ãã“ã¨ã‚‚ã§ãã‚‹ã—ã€ä¸Šè¿°ã®ã‚ˆã†ãªæ©Ÿæ§‹ã‚’ä¸€ã€…æ€ã„å‡ºã™å¿…è¦ã‚‚ãªã„ã®ã§ç†è§£ã®è² è·ãŒä½ã„ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚
`range`ãŒã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã§ã¯ãªãé…åˆ—ã‚’è¿”ã™ã‚ˆã†ã«ã™ã‚Œã°`[... ]`ã‚‚çœã„ã¦ã•ã‚‰ã«ç°¡æ½”ã«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ãã‚Œã¯`range`ã®æ±ç”¨æ€§ã‚’ä¸‹ã’ã‚‹ã—æœ¬é¡Œã¨ã¯é–¢ä¿‚ãªã„ã®ã§ã‚„ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

## `Number.range`

ã¡ãªã¿ã«ã€`Number.range`ã‚’ECMAScriptä»•æ§˜ã«è¿½åŠ ã—ã‚ˆã†ã¨ã„ã†ãƒ—ãƒ­ãƒãƒ¼ã‚¶ãƒ«ã‚‚ã‚ã‚Šã¾ã™ã€‚

- [Number.range & BigInt.range](https://github.com/tc39/proposal-Number.range)

ã“ã‚ŒãŒå°å…¥ã•ã‚Œã‚Œã°ã€æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹ã§ã—ã‚‡ã†ã€‚`Array(5).keys()`ã‚ˆã‚Šå¾®å¦™ã«é•·ã„ã§ã™ãŒã€èª­ã¿ã‚„ã™ã•ã®ãŸã‚ãªã‚‰é•·ã•ãªã©äº›ç´°ãªå•é¡Œã§ã™ï¼ˆã‚³ãƒ¼ãƒ‰ã‚´ãƒ«ãƒ•ã‚’ã—ãŸã„å ´åˆã¯åˆ¥ã§ã™ãŒï¼‰ã€‚

```js
console.log([...Number.range(0, 5)]);
```

## ã¾ã¨ã‚

`[...Array(5).keys()]`ã®ã‚ˆã†ãªæ›¸ãæ–¹ã¯ã€æ„å‘³ã‚’èªè­˜ã™ã‚‹ãŸã‚ã«çŸ¥ã£ã¦ã„ã‚‹ã¹ãäº‹é …ãŒå¤šãã¦ã‚„ã‚„ã“ã—ã„ã®ã§ã€èª­ã¿æ‰‹ã®è² è·ã‚’ä¸‹ã’ã‚‹ãŸã‚ã«ã¯é¿ã‘ã‚‹ã¹ãã§ã™ã€‚ä»£ã‚ã‚Šã«ã€ã‚ã‚‰ã‹ã˜ã‚`range`ã®ã‚ˆã†ãªé–¢æ•°ã‚’å®šç¾©ã—ã¦ãŠã„ã¦`[...range(0, 5)]`ã¨ã™ã‚‹ã®ãŒã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚

### ä½™è«‡: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è©±

ã“ã®è¨˜äº‹ã§æ‰±ã£ãŸã‚ˆã†ãªemptyã‚’å«ã‚€é…åˆ—ã¯ã€emptyã‚’å«ã¾ãªã„é…åˆ—ã«æ¯”ã¹ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸Šä¸åˆ©ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼ˆ[ä¾‹ãˆã°V8ã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’ã”è¦§ãã ã•ã„](https://v8.dev/blog/elements-kinds)ï¼‰ã€‚ã“ã®è¨˜äº‹ã§ã¯ç†è§£ã—ã‚„ã™ã•ã®è¦³ç‚¹ã‹ã‚‰è­°è«–ã—ã¾ã™ãŒã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è¦³ç‚¹ã‹ã‚‰ã‚‚emptyã‚’å«ã‚€é…åˆ—ã‚’ç„¡é—‡ã«æ‰±ã†ã¹ãã§ã¯ãªã„ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
